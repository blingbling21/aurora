# Aurora - 模块化量化交易研究框架

<p align="center">
  <img src="https://img.shields.io/badge/Code%20Generation-AI%20Powered-critical" alt="AI Generated">
  <img src="https://img.shields.io/badge/Status-Experimental-red" alt="Experimental">
  <img src="https://img.shields.io/badge/Use%20with%20Caution-EXTREME-yellow" alt="Extreme Caution">
</p>

> **🛑 严重警告：本项目完全由 AI 生成**
>
> **这是一个实验性项目，其几乎所有内容——包括需求规格、技术方案、全部 Rust 代码、所有测试（单元、集成、文档）、以及全部注释和文档——均由大型语言模型（LLM）生成。**
>
- **人类的角色**：作者仅作为**高级指导者**，负责提出需求、编排生成流程、并进行基本的整合与调整。作者并未逐行编写或深度审查所有代码。
- **核心风险**：代码中**极有可能**包含隐蔽的逻辑错误、严重的安全漏洞、性能陷阱以及其他不可预知的缺陷。**AI 生成的测试可能无法发现其自身生成的代码中的根本性问题（“自我验证谬误”）**。
>
> **严禁在任何生产环境、回测决策或涉及真实资金的场景中使用本项目的任何部分。**
> **使用者必须将本项目视为一个关于“AI 驱动软件开发”的学术案例，而非一个可靠的工具。所有风险由使用者自行承担。**

Aurora是一个使用Rust构建的模块化、事件驱动的量化交易研究框架。该框架提供高性能、高安全性的工具，支持从数据采集、策略回测到实时模拟交易的全流程。

## 项目特色

- 🚀 **高性能**: 基于Rust构建，具备零成本抽象和内存安全保证
- 🧩 **模块化**: 7个独立crate，各司其职，可自由组合
- ⚡ **事件驱动**: 统一的市场事件处理架构，支持历史和实时数据
- 📊 **完整工具链**: 数据采集→策略开发→回测验证→实时模拟，一站式解决方案
- 🔧 **可扩展**: 通过trait系统轻松扩展新的数据源、指标和策略
- 📈 **生产就绪**: 完善的测试覆盖、错误处理和日志记录

## 项目结构

### Cargo Workspace 成员

- **`aurora-core`** (库) - 核心数据结构和trait定义
  - K线数据结构和市场事件系统
  - 统一的数据源、策略、投资组合接口抽象
  - 交易信号和信号事件定义
  
- **`aurora-data`** (二进制) - 数据采集工具
  - 支持Binance历史数据下载（REST API）
  - 实时WebSocket数据流（K线和逐笔成交）
  - 自动重连和错误处理机制
  
- **`aurora-indicators`** (库) - 技术指标计算库
  - 20+ 种常用技术指标
  - 涵盖趋势、动量、波动率、成交量四大类别
  - 高效的滑动窗口实现，支持流式计算
  
- **`aurora-strategy`** (库) - 交易策略实现
  - 统一的策略接口抽象
  - MA交叉等经典策略实现
  - 支持自定义策略扩展
  
- **`aurora-portfolio`** (库) - 投资组合管理
  - 交易执行和权益追踪
  - 业绩分析和风险指标计算
  - 完整的交易历史记录
  
- **`aurora-backtester`** (二进制) - 历史回测引擎
  - 基于历史数据的策略验证
  - 详细的回测报告和统计分析
  - 严格的时间序列处理，避免未来函数
  
- **`aurora-live`** (二进制) - 实时模拟交易引擎
  - 7x24小时实时数据处理
  - 模拟交易执行（纸上交易）
  - 实时账户监控和业绩追踪

### 架构特点

- **模块化设计**: 各功能组件高度解耦，易于独立开发和测试
- **事件驱动**: 基于市场事件的统一处理架构，支持多种数据源
- **策略模式**: 通过`Strategy` trait实现可插拔的交易策略
- **异步支持**: 基于tokio的异步运行时，支持高并发数据处理
- **类型安全**: 利用Rust类型系统在编译期确保数据安全和逻辑正确性

## 快速开始

### 环境要求

- Rust 1.70+ (推荐使用最新稳定版)
- 网络连接 (用于获取市场数据)

### 编译项目
```bash
cargo build --release
```

### 运行测试
```bash
# 运行所有库测试
cargo test --lib

# 运行集成测试
cargo test
```

### 使用工具

#### 1. 数据采集 (aurora-data)
```bash
# 下载历史数据 - 支持多种时间间隔
cargo run -p aurora-data -- download --symbol BTCUSDT --interval 1h --output btc_1h.csv

# 指定时间范围下载
cargo run -p aurora-data -- download --symbol ETHUSDT --interval 4h --start-time 2024-01-01 --end-time 2024-12-31 --output eth_4h.csv

# 接收实时数据流 - 支持K线和逐笔成交
cargo run -p aurora-data -- stream --symbol BTCUSDT --interval 1m
cargo run -p aurora-data -- stream --symbol BTCUSDT --stream-type trade
```

#### 2. 历史回测 (aurora-backtester)
```bash
# 运行MA交叉策略回测
cargo run -p aurora-backtester -- --data-path btc_1h.csv --short 10 --long 30 --initial-cash 10000

# 查看详细回测报告
cargo run -p aurora-backtester -- --data-path btc_1h.csv --short 5 --long 20 --initial-cash 50000
```

#### 3. 实时模拟交易 (aurora-live)
```bash
# 启动实时模拟交易 - 支持7x24小时运行
cargo run -p aurora-live -- --symbol BTCUSDT --short 10 --long 30 --initial-cash 10000

# 使用不同策略参数
cargo run -p aurora-live -- --symbol ETHUSDT --short 5 --long 20 --initial-cash 20000
```

## 核心概念

### 数据结构
- **`Kline`**: K线数据结构，包含OHLCV和时间戳，支持序列化/反序列化
- **`MarketEvent`**: 市场事件枚举，统一不同类型的市场数据
- **`Signal`**: 交易信号枚举 (Buy/Sell/Hold)
- **`SignalEvent`**: 包含信号和元数据的事件结构
- **`Trade`**: 交易记录结构，支持多种交易类型

### Trait设计
- **`DataSource`**: 异步数据源统一接口，支持历史和实时数据
- **`Strategy`**: 策略统一接口，支持事件驱动的信号生成
- **`Portfolio`**: 投资组合管理接口，支持权益跟踪和风险控制

### 已实现组件

#### 技术指标 (aurora-indicators)
提供完整的技术分析指标库，包含20+种常用指标：

- **趋势指标**: MA、EMA、MACD、ADX、PSAR、Ichimoku
- **动量指标**: RSI、Stochastic、ROC、CCI、Williams %R
- **波动率指标**: Bollinger Bands、ATR、StdDev、Keltner Channels
- **成交量指标**: OBV、MFI、VWAP、CMF、ADLine

每个指标都具备：
  - 滑动窗口机制，内存高效
  - 状态管理，支持流式数据处理
  - 完整测试覆盖，包括边界条件

#### 交易策略 (aurora-strategy)
- **MA交叉策略**: 双均线交叉买卖信号
  - 金叉买入，死叉卖出
  - 状态维护，避免重复信号
  - 支持自定义短期和长期周期

#### 数据源集成 (aurora-data)
- **Binance数据源**: 完整的REST API和WebSocket支持
  - 历史数据下载，支持多种时间间隔
  - 实时数据流，自动重连机制
  - 数据验证和错误处理

#### 投资组合管理 (aurora-portfolio)
- **权益跟踪**: 实时计算总权益、持仓和现金
- **交易执行**: 统一的买卖操作接口，支持异步执行
- **业绩分析**: 收益率、最大回撤、夏普比率等多维度指标
- **权益曲线**: 记录和追踪投资组合的权益变化
- **交易记录**: 完整的交易历史管理，支持TradeBuilder构建

#### 回测引擎 (aurora-backtester)
- **历史数据回放**: 按时间顺序模拟市场环境
- **策略执行**: 支持任意策略实现
- **业绩报告**: 详细的回测结果和统计指标
- **无未来函数**: 严格的时间序列处理

#### 实时引擎 (aurora-live)
- **7x24小时运行**: 稳定的实时数据处理
- **模拟交易**: 安全的纸上交易，不涉及真实资金
- **实时监控**: 定期输出账户状态和业绩
- **错误恢复**: 网络断线自动重连

## 技术栈与依赖

### 核心依赖
- **`tokio`**: 异步运行时，支持高并发和非阻塞I/O
- **`serde`**: 序列化/反序列化框架，支持JSON和CSV格式
- **`anyhow`**: 错误处理，提供统一的错误类型
- **`tracing`**: 结构化日志记录，支持多级别日志

### 网络与数据
- **`reqwest`**: HTTP客户端，用于REST API调用
- **`tokio-tungstenite`**: WebSocket客户端，支持实时数据流
- **`csv`**: CSV文件处理，用于历史数据存储
- **`url`**: URL处理和验证

### 命令行与工具
- **`clap`**: 命令行接口框架，支持子命令和参数验证
- **`chrono`**: 时间处理库，支持时间戳转换
- **`async-trait`**: 异步trait支持

### 测试与开发
- **完整单元测试**: 119+ 测试用例，覆盖核心功能
- **集成测试**: 模块间协作验证
- **文档测试**: 代码示例自动验证
- **性能测试**: 大数据量处理验证

## 项目统计

- **模块数量**: 7个crate (4个库 + 3个二进制)
- **代码行数**: 15,000+ 行Rust代码
- **测试覆盖**: 390+ 测试用例
- **技术指标**: 20+ 种技术分析指标
- **文档完整性**: 所有公共API都有详细文档和示例
- **依赖管理**: 统一的workspace依赖版本管理

## 开发计划与完成状态

框架按照以下阶段开发，**所有阶段均已完成**：

- **阶段零**: ✅ **已完成** - 项目结构和基础工具
  - Cargo workspace配置
  - 统一的依赖管理
  - 开发环境和工具链设置

- **阶段一**: ✅ **已完成** - 数据核心 (数据采集和核心结构)
  - `aurora-core`: 完整的数据结构和trait定义
  - `aurora-data`: 历史数据下载和实时数据流功能
  - Binance API集成和WebSocket连接

- **阶段二**: ✅ **已完成** - 策略大脑 (指标和策略实现)
  - `aurora-indicators`: 移动平均线等技术指标
  - `aurora-strategy`: MA交叉等经典策略
  - 可扩展的策略框架设计

- **阶段三**: ✅ **已完成** - 历史回测引擎
  - `aurora-backtester`: 完整的回测引擎
  - `aurora-portfolio`: 投资组合管理
  - 业绩分析和风险指标计算

- **阶段四**: ✅ **已完成** - 实时模拟交易引擎
  - `aurora-live`: 7x24小时实时引擎
  - 模拟交易执行和状态监控
  - 错误处理和自动恢复机制

## 生产使用指南

### 风险提示

本项目本质上是一个关于 AI 在复杂软件工程中能力的探索性实验。因此，存在以下重大风险：

1.  **代码来源与可靠性**:
    - **完全由 AI 生成**：本项目的全部代码、测试和文档均由 AI 自动生成。人类作者并未参与逐行编码，也无法保证对每一处实现细节的完全理解和控制。
    - **逻辑缺陷风险**：AI 可能产生看似正确但包含细微、致命逻辑错误的算法。对于量化交易这种对精度和逻辑严密性要求极高的领域，此类风险是不可接受的。

2.  **安全漏洞**:
    - **未经审计**：代码库未经任何形式的人工安全审计。AI 可能从其训练数据中学习并复现了不安全的编码模式，从而引入严重的安全漏洞（如：不当的API密钥处理、数据泄露风险等）。

3.  **测试的局限性**:
    - **“自我验证谬误”**：所有测试用例同样由 AI 生成，它们很可能只能覆盖 AI“预想”到的正常路径和简单边界，而无法发现其自身思维模型之外的未知缺陷。测试通过**绝不代表**代码的正确性或健壮性。

4.  **免责声明**:
    - **本项目严格限定于学术研究和技术探讨目的。**
    - **严禁**将本项目的任何部分用于生产系统、投资决策辅助、或任何涉及真实金融资产的活动。
    - 任何因使用、修改或分发本项目而导致的直接或间接损失（包括但不限于资金损失、数据丢失、系统崩溃），**作者概不负责**。

### 性能特征

- **低延迟**: 基于Rust的零成本抽象，毫秒级响应
- **高吞吐**: 异步设计支持数千并发连接
- **内存安全**: 编译期保证，运行时零crash
- **资源效率**: 低内存占用，适合长期运行

### 扩展开发

- **新增指标**: 实现标准trait即可集成
- **自定义策略**: 继承Strategy trait开发新策略
- **多数据源**: 通过DataSource trait接入新的交易所
- **风控模块**: 在Portfolio层添加风险管理逻辑

## 文档与支持

### 完整文档
- [软件需求规格说明书](docs/软件需求规格说明书.md) - 详细的功能需求和验收标准
- [技术方案说明书](docs/技术方案说明书.md) - 系统架构和技术实现细节
- [项目大纲](docs/大纲.md) - 开发阶段和里程碑规划
- [项目约定](docs/项目约定.md) - 开发规范和测试策略

### API文档
```bash
# 生成本地文档
cargo doc --open

# 查看特定模块文档
cargo doc -p aurora-core --open
cargo doc -p aurora-strategy --open
```

### 示例代码
每个模块都包含详细的使用示例和文档测试，可作为学习参考。

### 贡献指南
- 遵循Rust社区编码规范
- 所有新功能必须包含测试
- 提交前运行 `cargo test` 和 `cargo clippy`
- 使用 `cargo fmt` 格式化代码

## 版本信息

- **当前版本**: 0.1.0
- **Rust版本要求**: 1.70+
- **最后更新**: 2025年10月13日

## 许可证

本项目采用Apache 2.0许可证。详情请参阅[LICENSE](LICENSE)文件。

---

**Aurora** - 让量化交易研究更加高效、安全、可靠 🚀